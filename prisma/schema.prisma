generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native","rhel-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model addresses {
  id            Int       @id @default(autoincrement())
  employee_id   Int
  address_line1 String
  address_line2 String?
  city          String
  state         String
  country       String
  pincode       String
  employees     employees @relation(fields: [employee_id], references: [empid], onDelete: Cascade, onUpdate: Restrict)

  @@index([employee_id])
}

model attendance {
  id                Int                           @id @default(autoincrement())
  empid             String
  check_in          DateTime?
  check_out         DateTime?
  total_hours       Decimal?
  date              DateTime?                     @default(now())
  created_at        DateTime?                     @default(now())
  attendance_status attendance_attendance_status? @default(Absent)
}

model audit_logs {
  id                                           Int        @id @default(autoincrement())
  empid                                        Int?
  performed_by                                 Int?
  action                                       String?
  timestamp                                    DateTime?  @default(now())
  employees_audit_logs_empidToemployees        employees? @relation("audit_logs_empidToemployees", fields: [empid], references: [empid], onDelete: Cascade, onUpdate: Restrict)
  employees_audit_logs_performed_byToemployees employees? @relation("audit_logs_performed_byToemployees", fields: [performed_by], references: [empid], onUpdate: Restrict)

  @@index([empid])
  @@index([performed_by])
}

model bank_details {
  id                  Int       @id @default(autoincrement())
  employee_id         Int
  account_holder_name String
  bank_name           String
  branch_name         String?
  account_number      String
  ifsc_code           String
  checkbook_document  String?
  employees           employees @relation(fields: [employee_id], references: [empid], onDelete: Cascade, onUpdate: Restrict)

  @@index([employee_id])
}

model candidates {
  id                    Int                @id @default(autoincrement())
  candidate_id          String?            @unique
  name                  String
  email                 String
  contact_number        String?
  interview_date        DateTime?
  interview_time_from   String?
  interview_time_to     String?
  resume                String?
  form_link             String?
  created_at            DateTime?          @default(now())
  form_token            String?            @unique
  interview_mail_status String?            @default("Not Sent")
  form_status           String?            @default("Mail Not Sent")
  status                candidates_status? @default(Waiting)
  verification          Boolean?           @default(false)
  form_submitted        Boolean            @default(false)
  device_info           String?
  ip_address            String?
  token_expiry          DateTime?
  token_first_used_at   DateTime?
}

model compliance_documents {
  id          Int        @id @default(autoincrement())
  empid       Int?
  doc_type    String?
  file_path   String?
  uploaded_at DateTime?  @default(now())
  expires_on  DateTime?
  employees   employees? @relation(fields: [empid], references: [empid], onDelete: Cascade, onUpdate: Restrict)

  @@index([empid])
}

model compliance_status {
  empid          Int                               @id
  last_updated   DateTime?                         @default(now())
  overall_status compliance_status_overall_status?
  employees      employees                         @relation(fields: [empid], references: [empid], onDelete: Cascade, onUpdate: Restrict)
}

model employees {
  empid                                         Int                    @id @default(autoincrement())
  candidate_id                                  String?
  main_employee_id                              String?                // Same as users.empid
  name                                          String?
  email                                         String?                @unique(map: "employees_email_unique")
  contact_no                                    String?
  password                                      String?
  gender                                        String?
  dob                                           DateTime?
  aadhar_card                                   String?
  pan_card                                      String?
  education_certificates                        String?
  resume                                        String?
  experience_certificate                        String?
  profile_photo                                 String?
  created_at                                    DateTime?              @default(now())
  experience_years                              Int?                   @default(0)
  experience_months                             Int?                   @default(0)
  aadhar_number                                 String?
  pan_number                                    String?
  highest_qualification                         String?
  addresses                                     addresses[]
  audit_logs_audit_logs_empidToemployees        audit_logs[]           @relation("audit_logs_empidToemployees")
  audit_logs_audit_logs_performed_byToemployees audit_logs[]           @relation("audit_logs_performed_byToemployees")
  bank_details                                  bank_details[]
  compliance_documents                          compliance_documents[]
  compliance_status                             compliance_status?

  @@index([email])
}

model candidate_details {
  id                                            Int                    @id @default(autoincrement())
  candidate_id                                  String?
  name                                          String?
  email                                         String?                @unique(map: "candidates_unique_email")
  contact_no                                    String?
  password                                      String?
  gender                                        String?
  dob                                           DateTime?
  aadhar_card                                   String?
  pan_card                                      String?
  education_certificates                        String?
  resume                                        String?
  experience_certificate                        String?
  profile_photo                                 String?
  aadhar_number                                 String?
  pan_number                                    String?
  highest_qualification                         String?
  addresses                                     candidates_addresses[]
  bank_details                                  candidates_bank_details[]
  created_at                                    DateTime?              @default(now())
}

model candidates_addresses {
  id                    Int       @id @default(autoincrement())
  candidate_id          Int
  address_line1         String
  address_line2         String?
  city                  String
  state                 String
  country               String
  pincode               String
  candidate_details     candidate_details @relation(fields: [candidate_id], references: [id])

  @@index([candidate_id])
}

model candidates_bank_details {
  id                  Int       @id @default(autoincrement())
  candidate_id        Int
  account_holder_name String
  bank_name           String
  branch_name         String?
  account_number      String
  ifsc_code           String
  checkbook_document  String?
  candidate_details           candidate_details @relation(fields: [candidate_id], references: [id])

  @@index([candidate_id])
}

model leave_types {
  id             Int              @id @default(autoincrement())
  max_days       Int
  paid           Boolean?         @default(true)
  type_name      String
  leave_balances leave_balances[]
}

model leave_balances {
  id          Int         @id @default(autoincrement())
  empid       String
  type_id     Int
  total       Int
  used        Int?        @default(0)
  remaining   Int?
  users       users       @relation(fields: [empid], references: [empid], onUpdate: Restrict)
  leave_types leave_types @relation(fields: [type_id], references: [id], onUpdate: Restrict)

  @@index([empid])
  @@index([type_id])
}

model leave_requests {
  id         Int                    @id @default(autoincrement())
  empid      String
  from_date  DateTime
  to_date    DateTime
  reason     String?
  applied_at DateTime?              @default(now())
  attachment String?
  leave_type String
  name       String
  status     leave_requests_status? @default(Pending)
  users      users                  @relation(fields: [empid], references: [empid], onDelete: Cascade, onUpdate: Restrict)

  @@index([empid])
}

model users {
  id               Int                      @id @default(autoincrement())
  empid            String                   @unique
  name             String
  email            String                   @unique
  contact_number   String?
  password         String
  position         String?
  date_of_joining  DateTime?
  status           String?                  @default("Active")
  experience       Int?
  profile_photo    String?
  created_at       DateTime?                @default(now())
  role             users_role               @default(employee)
  verified         users_verified?          @default(not_verified)
  form_submitted   Boolean                  @default(false)
  resetToken       String?
  resetTokenExpiry DateTime?                @db.Timestamp(6)
  employee_type    employees_employee_type? @default(Full_time)
  candidate_id     String?
  duration_months  Int?
  leave_balances   leave_balances[]
  leave_requests   leave_requests[]
  payroll          payroll[]
  createdTasks     tasks[]                  @relation("TaskCreator")
  assignedTasks    tasks[]                  @relation("TaskAssignee")
  positions        positions[]
}

model payroll {
  id                Int       @id @default(autoincrement())
  empid             String?
  month             String?
  year              Int?
  basic_salary      Decimal?
  hra               Decimal?
  bonus             Decimal?  @default(0.00)
  da                Decimal?
  allowances        Decimal?
  deductions        Decimal?
  net_pay           Decimal?
  generated_on      DateTime? @default(now())
  payslip_pdf       String?
  payslip_status    payslip_status?    @default(pending)
  pf                Decimal?  @default(0.00)
  ptax              Decimal?  @default(0.00)
  esic              Decimal?  @default(0.00)
  allowance_details String?
  deduction_details String?
  users             users?    @relation(fields: [empid], references: [empid], onDelete: Restrict, onUpdate: Restrict)

  @@index([empid])
}
enum payslip_status {
  pending
  generated
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model employees_backup {
  empid                  Int       @id
  candidate_id           String?   @db.VarChar(50)
  name                   String?   @db.VarChar(100)
  email                  String?   @db.VarChar(100)
  contact_no             String?   @db.VarChar(15)
  password               String?   @db.VarChar(100)
  address                String?
  gender                 String?   @db.VarChar(10)
  dob                    DateTime? @db.Date
  aadhar_card            String?
  pan_card               String?
  education_certificates String?
  resume                 String?
  experience_certificate String?
  bank_details           String?
  profile_photo          String?
  created_at             DateTime? @default(now()) @db.Timestamp(0)
}

model calendar_events {
  id          Int      @id @default(autoincrement())
  title       String
  description String?
  event_date  DateTime
  event_type  String
  visible_to  String   @default("all")
  created_by  String
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

model contact_submissions {
  id         Int       @id @default(autoincrement())
  name       String
  email      String
  subject    String
  message    String
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model assistant_learning {
  id               Int      @id @default(autoincrement())
  question         String
  response         String
  user_id          String?  @db.VarChar(255)
  intent_category  String?  @db.VarChar(100)
  intent_labels    String?
  confidence_score Decimal? @db.Decimal(3, 2)
  frequency        Int      @default(1)
  created_at       DateTime @default(now())
  last_asked       DateTime @default(now())
}

model tasks {
  id          Int      @id @default(autoincrement())
  title       String
  description String?
  assigned_to String
  assigned_by String
  deadline    DateTime
  priority    String   @default("Medium")
  status      String   @default("Pending")
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  creator     users    @relation("TaskCreator", fields: [assigned_by], references: [empid])
  assignee    users    @relation("TaskAssignee", fields: [assigned_to], references: [empid])
}

model positions {
  id            Int      @id @default(autoincrement())
  position_name String
  description   String?
  created_by    String
  created_at    DateTime @default(now())
  users         users    @relation(fields: [created_by], references: [empid])

  @@index([created_by])
}

enum EventType {
  holiday
  event
}

enum compliance_status_overall_status {
  Compliant
  Expiring_Soon @map("Expiring Soon")
  Non_compliant @map("Non-compliant")
}

enum leave_requests_status {
  Pending
  Approved
  Rejected
}

enum attendance_attendance_status {
  Present
  Absent
}

enum candidates_status {
  Waiting
  Pending
  Mail_Sent          @map("Mail Sent")
  Document_Submitted @map("Document Submitted")
  Selected
  Rejected
  
}

enum users_role {
  hr
  employee
  admin
  ceo
  superadmin
}

enum users_verified {
  verified
  not_verified @map("not verified")
}

enum employees_employee_type {
  Full_time  @map("Full-time")
  Intern
  Contractor
}
